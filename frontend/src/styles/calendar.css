/* React Big Calendar Custom Styles */

/* Mobile utility classes */
.mobile-only {
  display: none;
}

.desktop-only {
  display: block;
}

@media (max-width: 768px) {
  .mobile-only {
    display: block;
  }

  .desktop-only {
    display: none;
  }
}

/* Main calendar container */
.calendar-container {
  @apply bg-white rounded-lg shadow-sm;
  /* Height is set via style prop on Calendar component (required for react-big-calendar) */
}

/* Calendar header */
.rbc-header {
  @apply bg-gray-50 text-gray-700 font-medium py-3 text-center border-b border-gray-200;
}

/* Calendar toolbar */
.rbc-toolbar {
  @apply mb-4;
}

.rbc-toolbar button {
  @apply btn text-sm;
}

.rbc-toolbar button:hover {
  @apply bg-gray-100;
}

.rbc-toolbar button.rbc-active {
  @apply bg-primary-100 text-primary-700;
}

/* Calendar grid */
.rbc-month-view {
  @apply border border-gray-200 rounded-lg overflow-hidden;
  /* Height is automatically calculated by react-big-calendar based on container */
}

.rbc-date-cell {
  @apply relative p-2 min-h-[80px] border-r border-gray-200 hover:bg-gray-50 cursor-pointer;
}

.rbc-date-cell:last-child {
  @apply border-r-0;
}

/* Month row borders - override react-big-calendar default to match our design */
.rbc-month-row + .rbc-month-row {
  border-top: 1px solid rgb(229 231 235); /* border-gray-200 */
}

.rbc-date-cell.rbc-off-range {
  @apply bg-gray-50 text-gray-400;
}

.rbc-date-cell.rbc-today {
  @apply bg-blue-100;
}

/* Remove today highlight in day view */
.rbc-time-view .rbc-today {
  @apply bg-white;
}

.rbc-date-number {
  @apply text-sm font-medium text-gray-900;
}

/* Events */
.rbc-event {
  @apply rounded-md border-0 text-sm font-medium cursor-pointer;
  padding: 2px 4px;
  margin: 1px 0;
  /* Allow text wrapping in week view */
  white-space: normal !important;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.rbc-event:hover {
  @apply opacity-90;
}

/* Hide react-big-calendar's automatic time display - we show it in our custom component */
.rbc-event-label {
  display: none !important;
}


/* Time slots for day/week view */
.rbc-time-view {
  @apply border border-gray-200 rounded-lg overflow-hidden;
}

/* Allow vertical scrolling in week view */
/* The time-view should be the scrollable container */
.rbc-week-view .rbc-time-view {
  display: flex !important;
  flex-direction: column !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  position: relative !important;
  /* Responsive max-height: 600px on desktop, smaller on mobile */
  max-height: min(600px, calc(100vh - 200px)) !important;
}

.rbc-time-header {
  @apply bg-gray-50 border-b border-gray-200;
}

/* Root cause fix: Don't hide overflowing time header - we need it visible for week view */
/* The rbc-overflowing class is added by react-big-calendar when content overflows, but we still need to show the headers */
.rbc-time-header.rbc-overflowing {
  display: block !important;
}

.rbc-time-header-content {
  @apply text-sm font-medium text-gray-700;
}

/* Fix alignment between header cells and event columns in week view only */
/* Use class added by JavaScript to scope styles to week view */
.rbc-week-view .rbc-time-header {
  display: table !important;
  width: 100% !important;
  table-layout: fixed !important;
  position: sticky !important;
  top: 0 !important;
  z-index: 10 !important;
  background-color: rgb(249 250 251) !important; /* bg-gray-50 */
  flex-shrink: 0 !important;
  box-sizing: border-box !important;
  /* Ensure header starts at the same position as content */
  margin: 0 !important;
  padding: 0 !important;
  border-collapse: collapse !important;
  border-spacing: 0 !important;
}

.rbc-week-view .rbc-time-header .rbc-time-header-gutter {
  display: table-cell !important;
  width: auto !important;
  vertical-align: middle !important;
  box-sizing: border-box !important;
  padding: 0 !important;
  margin: 0 !important;
}

.rbc-week-view .rbc-time-header .rbc-time-header-content {
  display: table-cell !important;
  width: auto !important;
  vertical-align: middle !important;
}

.rbc-week-view .rbc-time-header .rbc-row.rbc-time-header-cell {
  display: table-row !important;
}

.rbc-week-view .rbc-time-header .rbc-header {
  display: table-cell !important;
  width: auto !important;
  vertical-align: middle !important;
  box-sizing: border-box !important;
  padding: 0 !important;
  margin: 0 !important;
}

/* Highlight current day in week view header with same blue as monthly view */
.rbc-week-view .rbc-time-header .rbc-header.rbc-today {
  @apply bg-blue-100;
}

/* Hide all-day cell when there are no all-day events */
/* This hides the empty all-day row that appears in month and week views */
.rbc-allday-cell:not(:has(.rbc-allday-event)) {
  display: none !important;
}

/* Ensure all-day cell uses table layout - only for week view when it has events */
.rbc-week-view .rbc-allday-cell:has(.rbc-allday-event) {
  display: table !important;
  width: 100% !important;
  table-layout: fixed !important;
}

.rbc-week-view .rbc-allday-cell:has(.rbc-allday-event) .rbc-row-bg {
  display: table-row !important;
}

.rbc-week-view .rbc-allday-cell:has(.rbc-allday-event) .rbc-row-bg .rbc-day-bg {
  display: table-cell !important;
  width: auto !important;
  vertical-align: top !important;
}

/* Day view time content - keep original styling (week view already has border-t above) */
.rbc-time-content {
  @apply border-t border-gray-200;
}

/* Week view time content - maintain table layout for alignment */
/* The parent .rbc-time-view is the scrollable container */
.rbc-week-view .rbc-time-content {
  @apply border-t border-gray-200;
  display: table !important;
  width: 100% !important;
  table-layout: fixed !important;
  flex: 0 0 auto !important;
  box-sizing: border-box !important;
  /* Ensure content starts at the same position as header */
  margin: 0 !important;
  padding: 0 !important;
  border-collapse: collapse !important;
  border-spacing: 0 !important;
  /* Don't make this scrollable - parent handles scrolling */
}

.rbc-week-view .rbc-time-content > .rbc-time-gutter {
  display: table-cell !important;
  width: auto !important;
  vertical-align: top !important;
  box-sizing: border-box !important;
  padding: 0 !important;
  margin: 0 !important;
}

.rbc-week-view .rbc-time-content > .rbc-time-gutter .rbc-time-column {
  display: flex !important;
  flex-direction: column !important;
  align-items: flex-end !important;
}

.rbc-week-view .rbc-time-content > .rbc-day-slot {
  display: table-cell !important;
  width: auto !important;
  vertical-align: top !important;
  box-sizing: border-box !important;
  padding: 0 !important;
  margin: 0 !important;
}

/* Override scrollbar margin that can cause misalignment */
.rbc-calendar .rbc-time-view .rbc-time-header.rbc-overflowing {
  margin-right: unset !important;
}

.rbc-timeslot-group,
.rbc-day-view .rbc-time-slot {
  @apply border-b border-gray-100;
}

.rbc-time-slot {
  @apply text-xs text-gray-500 py-1;
}

/* Right-align time gutter labels using flexbox */
/* For day view, apply flex directly to time gutter */
.rbc-time-view .rbc-time-gutter {
  display: flex !important;
  flex-direction: column !important;
  align-items: flex-end !important;
}

/* For week view, time gutter is table-cell (set above), so flex goes on inner wrapper */
.rbc-week-view .rbc-time-content > .rbc-time-gutter .rbc-time-column {
  display: flex !important;
  flex-direction: column !important;
  align-items: flex-end !important;
}

.rbc-time-view .rbc-time-gutter .rbc-time-slot,
.rbc-time-content > .rbc-time-gutter .rbc-time-slot {
  display: flex !important;
  justify-content: flex-end !important;
  align-items: flex-start !important;
  width: 100% !important;
  padding-right: 4px !important;
  padding-top: 2px !important;
  box-sizing: border-box !important;
}

/* Day slot styles */
.rbc-day-slot .rbc-events-container,
.rbc-day-view .rbc-events-container {
  @apply mr-0;
}

.rbc-day-slot .rbc-event {
  @apply rounded-md border-0 text-xs;
  margin: 1px 2px;
}

/* Month view specific */
.rbc-month-view .rbc-date-cell {
  @apply min-h-[100px];
}

/* Hide events in month view on mobile */
@media (max-width: 768px) {
  .rbc-month-view .rbc-event {
    display: none !important;
  }
}

/* Mobile optimizations */
@media (max-width: 768px) {
  .calendar-container {
    height: 500px;
    @apply rounded-none shadow-none;
  }
  
  .rbc-date-cell {
    @apply min-h-[60px] p-1;
  }
  
  .rbc-date-number,
  .rbc-event {
    @apply text-xs;
  }
  
  .rbc-event {
    padding: 1px 2px;
  }
  
  .rbc-toolbar button {
    @apply px-2 py-1 text-xs;
  }
  
  /* Day view mobile optimizations */
  .rbc-time-view {
    @apply overflow-x-auto;
  }
  
  /* Reduce time gutter width on mobile to save space */
  /* Only apply to day view - week view uses table layout and needs width syncing */
  .rbc-day-view .rbc-time-gutter,
  .rbc-day-view .rbc-time-gutter.rbc-time-column {
    min-width: 45px !important;
    max-width: 45px !important;
    padding: 0 4px !important;
  }
  
  /* Increase spacing between time slots on mobile */
  .rbc-time-slot {
    @apply py-2;
    min-height: 48px !important;
  }
  
  /* Increase event padding on mobile */
  .rbc-day-view .rbc-event {
    padding: 4px 6px !important;
    margin: 2px 4px !important;
    font-size: 0.75rem !important;
    line-height: 1.4;
  }
  
  /* More spacing in day slot */
  .rbc-day-slot {
    min-height: 48px !important;
  }
  
  /* Increase time header content padding */
  /* Exclude week view - it uses table layout and padding would break alignment */
  .rbc-day-view .rbc-time-header-content {
    @apply px-3 py-2;
  }
  
  /* Ensure week view header content has no padding for alignment */
  .rbc-week-view .rbc-time-header .rbc-time-header-content {
    padding: 0 !important;
  }

  /* Week view event text wrapping */
  .rbc-week-view .rbc-event {
    white-space: normal !important;
    word-wrap: break-word;
    overflow-wrap: break-word;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    line-height: 1.3;
    padding: 2px 4px !important;
  }
  
}

/* FAB animations */
@keyframes slide-up {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slide-up {
  animation: slide-up 0.2s ease-out;
}
