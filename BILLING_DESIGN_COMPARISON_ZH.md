# 計費情境設計方案比較

## 執行摘要

本文件比較診所管理系統的不同計費情境設計方案，分析其優缺點與適用情境。同時提出新的設計替代方案，以解決已發現的限制。

## 現有設計方案比較

| 面向 | 設計一：原始（扁平式） | 設計二：階層式 | 設計三：簡易（可編輯） |
|------|----------------------|---------------|---------------------|
| **結構** | 治療師 → 情境清單 | 服務項目 → 治療師 → 情境清單 | 服務項目 → 治療師 → 單一可編輯情境 |
| **複雜度** | 低 | 高 | 中 |
| **彈性** | 高 - 任何項目可選任何情境 | 中 - 情境綁定服務/治療師 | 高 - 金額/分潤完全可編輯 |
| **錯誤預防** | 低 - 無對應驗證 | 高 - 強制階層結構 | 中 - 自動填入有助減少錯誤 |
| **可稽核性** | 中 - 只需審查「其他」 | 高 - 只需審查「其他」 | 低 - 所有項目需人工審查 |
| **使用者體驗** | 簡單選擇 | 循序選擇（3步驟） | 循序選擇（2步驟 + 編輯） |
| **設定複雜度** | 低 - 每位治療師扁平清單 | 高 - 每項服務的巢狀結構 | 中 - 每項服務/治療師一個情境 |
| **適用情境** | 小型診所，簡單需求 | 大型診所，複雜定價 | 中型診所，需要彈性 |
| **主要優點** | 簡單且彈性 | 防止錯誤，結構清晰 | 簡單且彈性 |
| **主要缺點** | 可能選錯情境 | 設定較複雜 | 難以稽核（全部可編輯） |

### 詳細分析

#### 設計一：原始（扁平式）
**結構：**
- 每位治療師有一個扁平的情境清單
- 每個情境包含：名稱、金額、分潤
- 結帳時：使用者選擇項目類型，然後從治療師的清單中選擇任何情境

**優點：**
- 簡單易懂，設定快速
- 非常彈性 - 可以混合搭配情境
- 配置速度快

**缺點：**
- 無驗證機制 - 使用者可能意外選錯情境（例如：為「運動治療」項目選擇「初診」情境）
- 可能產生計費錯誤
- 結構性較弱

#### 設計二：階層式
**結構：**
- 服務項目 → 治療師 → 情境清單
- 每個服務項目展開顯示提供該服務的治療師
- 每位治療師顯示該服務的情境
- 結帳時：選擇服務 → 選擇治療師 → 選擇情境

**優點：**
- 強力錯誤預防 - 情境綁定特定服務
- 結構清晰有組織
- 易於稽核 - 只需審查「其他」情境
- 防止意外選錯

**缺點：**
- 設定與維護較複雜
- 結帳時需要更多點擊（3步驟流程）
- 對簡單使用情境可能過於複雜

#### 設計三：簡易（可編輯）
**結構：**
- 服務項目 → 治療師 → 單一情境（金額/分潤）
- 每個服務/治療師配對有一個預設情境
- 結帳時：選擇服務 → 選擇治療師 → 自動填入可編輯欄位

**優點：**
- 結構簡單 - 每項服務/治療師一個情境
- 彈性 - 金額可編輯
- 結帳流程快速
- 自動填入減少錯誤

**缺點：**
- 難以稽核 - 治療師可編輯任何數值
- 無變更記錄
- 負責人必須審查所有項目，不只是例外情況
- 可能產生不一致的計費

## 新提案設計方案

### 設計四：預設值與覆寫標記

**結構：**
- 類似設計三（服務項目 → 治療師 → 單一情境）
- 每個情境有可編輯的金額/分潤欄位
- **新功能：**「覆寫」核取方塊/切換開關
- 啟用覆寫時，該項目會被標記需稽核
- 負責人只需審查標記的項目

**優點：**
- 結構簡單如設計三
- 更好的可稽核性 - 只需審查覆寫的項目
- 保持彈性
- 清晰的稽核記錄

**缺點：**
- 需要使用者記得勾選覆寫
- 仍允許未標記的編輯

---

### 設計五：情境範本與驗證

**結構：**
- 類似設計一（每位治療師扁平清單）
- **新功能：** 每個情境有「適用服務」清單
- 結帳時：只顯示適用於所選服務項目的情境
- 使用者仍可選擇「其他」作為自訂情境

**優點：**
- 保持設計一的簡單性
- 防止選錯情境
- 透過「其他」選項保持彈性
- 易於稽核（只需審查「其他」）

**缺點：**
- 需要維護每個情境的服務對應
- 設定比設計一稍複雜

---

### 設計六：混合式 - 預設值與自訂覆寫

**結構：**
- 服務項目 → 治療師 → 預設情境（類似設計三）
- **新功能：**「使用自訂金額」切換開關
- 啟用時，顯示自訂金額/分潤欄位
- 預設情境始終可見作為參考
- 自訂覆寫會被標記需稽核

**優點：**
- 兩全其美 - 預設值 + 彈性
- 預設與自訂有清晰的視覺區別
- 易於稽核 - 只需審查自訂項目
- 防止意外編輯預設值

**缺點：**
- 使用者介面稍複雜
- 自訂金額需要兩步驟流程

---

### 設計七：變更追蹤與稽核記錄

**結構：**
- 類似設計三（簡易可編輯）
- **新功能：** 追蹤所有變更，包含時間戳記和使用者
- 顯示「原始」與「修改後」的數值
- 負責人可查看變更內容與變更者
- 標記金額/分潤與預設值差異顯著的項目

**優點：**
- 完全透明與可稽核性
- 保持彈性
- 變更歷史記錄
- 可設定自動標記的閾值

**缺點：**
- 後端實作較複雜
- 需要使用者追蹤
- 需儲存更多資料

---

### 設計八：角色權限與審核流程

**結構：**
- 類似設計三（簡易可編輯）
- **新功能：** 角色權限
- 治療師可在預設值 ±10% 範圍內編輯
- 超過閾值的變更需要負責人核准
- 負責人可為每項服務/治療師設定審核規則

**優點：**
- 防止未授權的大幅變更
- 保持小幅調整的彈性
- 清晰的審核流程
- 良好的可稽核性

**缺點：**
- 權限系統較複雜
- 需要審核流程實作
- 可能減慢結帳流程

---

## 建議矩陣

| 設計 | 最適合 | 複雜度 | 可稽核性 | 彈性 | 錯誤預防 |
|------|--------|--------|---------|------|---------|
| **設計一** | 小型診所，簡單需求 | ⭐ 低 | ⭐⭐ 中 | ⭐⭐⭐ 高 | ⭐ 低 |
| **設計二** | 大型診所，複雜定價 | ⭐⭐⭐ 高 | ⭐⭐⭐ 高 | ⭐⭐ 中 | ⭐⭐⭐ 高 |
| **設計三** | 中型診所，需要彈性 | ⭐⭐ 中 | ⭐ 低 | ⭐⭐⭐ 高 | ⭐⭐ 中 |
| **設計四** | 中型診所，需要可稽核性 | ⭐⭐ 中 | ⭐⭐⭐ 高 | ⭐⭐⭐ 高 | ⭐⭐ 中 |
| **設計五** | 中小型診所 | ⭐ 低 | ⭐⭐⭐ 高 | ⭐⭐⭐ 高 | ⭐⭐⭐ 高 |
| **設計六** | 多數診所（推薦） | ⭐⭐ 中 | ⭐⭐⭐ 高 | ⭐⭐⭐ 高 | ⭐⭐⭐ 高 |
| **設計七** | 大型診所，嚴格稽核 | ⭐⭐⭐ 高 | ⭐⭐⭐ 高 | ⭐⭐⭐ 高 | ⭐⭐ 中 |
| **設計八** | 需要審核的診所 | ⭐⭐⭐ 高 | ⭐⭐⭐ 高 | ⭐⭐ 中 | ⭐⭐⭐ 高 |

## 前三名推薦

### 🥇 **設計六：混合式 - 預設值與自訂覆寫**
**原因：** 在簡單性、彈性和可稽核性之間取得最佳平衡。預設值與自訂值有清晰的視覺區別，使稽核變得容易。

### 🥈 **設計五：情境範本與驗證**
**原因：** 解決設計一的主要弱點（選錯情境），同時保持簡單性。易於稽核，因為只需審查「其他」。

### 🥉 **設計四：預設值與覆寫標記**
**原因：** 顯著改善設計三的可稽核性，同時保持其簡單性。自動標記減少人工工作。

## 實作考量

1. **使用者訓練：** 設計六和八需要更多使用者訓練
2. **後端複雜度：** 設計七和八需要更多後端基礎設施
3. **遷移路徑：** 考慮如何從現有設計遷移
4. **效能：** 設計二和七在大型資料集上可能有效能影響
5. **行動裝置體驗：** 設計六的切換開關可能更適合桌面版

## 下一步

1. **利害關係人審查：** 向診所負責人和治療師展示設計方案
2. **原型製作：** 為前 2-3 個設計建立快速原型
3. **使用者測試：** 與實際使用者測試以驗證假設
4. **成本效益分析：** 評估實作工作量與效益
5. **決策：** 根據診所規模、需求和資源選擇設計方案
